<system>
  # equal to -qq option
  log_level trace
</system>
<source>
  @type tail
  path /var/log/ranger/audit/archive/*
  pos_file /var/log/ranger/audit/ranger-audit.log.pos
  tag apps-logs
  <parse>
    @type json
  </parse>
</source>

<match apps-logs>
  @type cloudwatch_logs
  log_group_name staging-fluentd-apps-logs
  log_stream_name apps-logs
  auto_create_stream true
  region us-east-1
  <buffer>
    flush_mode immediate
  </buffer>
</match>

<match s3-logs>
  @type s3

  s3_bucket aws-logs-128235906652-us-east-1
  s3_region us-east-1
  s3_object_key_format %{path}%{time_slice}_%{index}.%{file_extension}
  path logs/
  buffer_path /var/log/fluent/s3

  time_slice_format %Y%m%d-%H
  time_slice_wait 10m
  utc
</match>
